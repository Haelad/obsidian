
**Poetry** - это инструмент для управления пакетами python, являющейся более удобным аналогом встроенного менеджера pip. [документация](https://python-poetry.org/docs/cli/?utm_source=chatgpt.com)
# Установка

Для начала работы требуется установить его. Есть два варианта

1. Через обыкновенный pip - `pip install poetry`
2. Либо более гибким вариантом через powershell - `(Invoke-WebRequest -Uri https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py - UseBasicParsing).Content | python -`

# Команды

| Команда                   | Назначение                                  | Ключевые флаги / примеры                                     |
| ------------------------- | ------------------------------------------- | ------------------------------------------------------------ |
| `poetry new <project>`    | Создать новый проект                        | `--src` — создать папку `src/`                               |
| `poetry init`             | Инициализация Poetry в существующем проекте | Интерактивная настройка `pyproject.toml`                     |
| `poetry install`          | Установка зависимостей                      | `--no-dev`, `--sync`, `--only <группа>`                      |
| `poetry add <package>`    | Добавить пакет                              | `--dev` — для dev-зависимостей, `@^1.2.3` — указать версию   |
| `poetry remove <package>` | Удалить пакет                               | —                                                            |
| `poetry update`           | Обновить зависимости и lock-файл            | `--dry-run` — посмотреть, что будет обновлено                |
| `poetry lock`             | Обновить `poetry.lock` без установки        | `--no-update` — не обновлять уже заблокированные зависимости |
| `poetry show`             | Показать дерево зависимостей                | `--tree`, `--latest`, `poetry show <package>`                |
| `poetry run <command>`    | Запуск команды внутри окружения             | Пример: `poetry run python script.py`                        |
| `poetry config`           | Настройка параметров Poetry                 | `--list`, `<name> <value>`, `--local`                        |
| `poetry self`             | Управление самим Poetry                     | `self update`, `self remove`, `self show`                    |
| `poetry source`           | Управление репозиториями                    | `source add`, `source show`, `source remove`                 |
| `poetry export`           | Экспорт зависимостей в `requirements.txt`   | `--output <file>`, `--with <groups>`                         |

## Флаги

Общие глобальные опции (доступны для любой команды):

| Флаг / опция                      | Назначение                             | Примечание / сокращение                                                            |
| --------------------------------- | -------------------------------------- | ---------------------------------------------------------------------------------- |
| `--verbose` / `-v`, `-vv`, `-vvv` | Увеличить детализацию вывода           | Много уровней детализации                                                          |
| `--help` / `-h`                   | Показать справку по команде            | —                                                                                  |
| `--quiet` / `-q`                  | Вывод без лишней информации            | —                                                                                  |
| `--ansi` / `--no-ansi`            | Принудительный (де)вывод ANSI          | —                                                                                  |
| `--version` / `-V`                | Показать версию Poetry                 | —                                                                                  |
| `--no-interaction` / `-n`         | Не запрашивать подтверждения           | Полезно для скриптов                                                               |
| `--no-plugins`                    | Отключить плагины                      | —                                                                                  |
| `--no-cache`                      | Не использовать кеш                    | —                                                                                  |
| `--directory=DIRECTORY` / `-C`    | Указать рабочую директорию для команды | —                                                                                  |
| `--project=PROJECT` / `-P`        | Указать корень проекта                 | Ссылка: [документация](https://python-poetry.org/docs/cli/?utm_source=chatgpt.com) |

----
# Преимущества poetry по сравнению с pip

## Особенности Poetry и принципы его работы

1. **Единый файл конфигурации**  
    Все данные о проекте — название, версия, зависимости, скрипты и пр. — хранятся в `pyproject.toml`.

2. **Автоматическое управление зависимостями**  
    Этот механизм обеспечивает **детерминированность** окружения, упомянутую выше: Poetry автоматически подбирает совместимые зависимости проекта и фиксирует их точные версии в `poetry.lock`.

3. **Изолированные окружения**  
    Инструмент автоматически создаёт и использует виртуальное окружение (venv), сохраняя проект изолированным от системных пакетов Python.

4. **Управление через простые команды**  
    Добавление, обновление и удаление пакетов, а также запуск кода выполняются через единый интерфейс CLI Poetry
    `poetry <команда> [аргументы] [опции/флаги]`

5. **Поддержка групп зависимостей**  
    Можно разделять зависимости на основные (`main`), для разработки (`dev`), тестов и других групп, устанавливая их выборочно.

6. **Сборка и публикация пакетов**  
    Poetry умеет собирать дистрибутивы (`wheel`, `sdist`) и публиковать их на PyPI или в собственные репозитории без необходимости писать `setup.py`.

7. **Настраиваемость и расширяемость**  
    Конфигурацию можно изменить через `poetry config`, а функциональность — расширить плагинами.

# Вывод

- **Функциональность** - Позволяет управлять зависимостями проекта: устанавливать, удалять, обновлять, описывать.  Публиковать и собирать проект как пакет.
- **Гибкость** - Заменяет круглый спектр инструментов для управлением зависимостями в один файл - `pyproject.toml`
- **Детерминированность** - Poetry использует файл блокировки (`poetry.lock`) для фиксации точных версий зависимостей, что обеспечивает воспроизводимость окружения на разных машинах/у разработчиков.

>[!info] Все эти преимущества раскрываются через особенности, описанные выше.
